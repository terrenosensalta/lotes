<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nokia 1100 Snake Retro</title>
    <style>
        body {
            background-color: #2c3e50;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            font-family: 'Courier New', Courier, monospace;
            overflow: hidden;
            touch-action: manipulation;
        }

        /* El cuerpo del celular - Ajustado para la pantalla más grande */
        .nokia-frame {
            background-color: #95a5a6;
            padding: 30px;
            border-radius: 60px 60px 120px 120px;
            box-shadow: 15px 15px 0px #7f8c8d;
            border: 5px solid #34495e;
            user-select: none;
            max-width: 90vw;
        }

        /* Pantalla LCD mucho más grande */
        #game-board {
            background-color: #94b41d; /* Verde amarillento clásico */
            border: 12px solid #2c3e50;
            display: grid;
            /* Aumentamos de 15px a 25px por celda */
            grid-template-columns: repeat(20, 25px);
            grid-template-rows: repeat(20, 25px);
            box-shadow: inset 4px 4px 10px rgba(0,0,0,0.5);
            position: relative;
        }

        .snake {
            background-color: #1a1a1a;
            border: 1px solid #94b41d;
        }

        .food {
            background-color: #1a1a1a;
            border-radius: 20%;
            animation: blink 0.5s infinite alternate;
        }

        @keyframes blink {
            from { opacity: 1; }
            to { opacity: 0.5; }
        }

        .score {
            text-align: center;
            font-weight: bold;
            color: #1a1a1a;
            margin-bottom: 10px;
            text-transform: uppercase;
            font-size: 1.5rem;
        }

        /* Controles para móviles */
        .controls {
            margin-top: 25px;
            display: grid;
            grid-template-columns: repeat(3, 70px);
            gap: 15px;
        }

        .btn {
            width: 70px;
            height: 70px;
            background: #34495e;
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 24px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 5px #2c3e50;
        }

        .btn:active {
            box-shadow: 0 0px #2c3e50;
            transform: translateY(5px);
        }

        .btn-up { grid-column: 2; }
        .btn-left { grid-column: 1; }
        .btn-right { grid-column: 3; }
        .btn-down { grid-column: 2; }

        .game-over-msg {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(148, 180, 29, 0.95);
            padding: 20px;
            text-align: center;
            border: 3px solid #1a1a1a;
            display: none;
            z-index: 10;
            width: 80%;
            font-size: 1.2rem;
        }
    </style>
</head>
<body>

    <div class="nokia-frame">
        <div class="score">Puntos: <span id="scoreVal">0</span></div>
        <div id="game-board">
            <div id="msg" class="game-over-msg">
                <strong>GAME OVER</strong><br>
                <small>Presiona una tecla o botón para reiniciar</small>
            </div>
        </div>
    </div>

    <div class="controls">
        <button class="btn btn-up" onclick="setDir(0, -1)">▲</button>
        <button class="btn btn-left" onclick="setDir(-1, 0)">◀</button>
        <button class="btn btn-right" onclick="setDir(1, 0)">▶</button>
        <button class="btn btn-down" onclick="setDir(0, 1)">▼</button>
    </div>

    <script>
        const board = document.getElementById('game-board');
        const scoreElement = document.getElementById('scoreVal');
        const msg = document.getElementById('msg');
        const gridSize = 20;
        
        let snake = [{x: 10, y: 10}];
        let food = {x: 15, y: 15};
        let direction = {x: 0, y: 0};
        let nextDirection = {x: 0, y: 0};
        let score = 0;
        let gameRunning = true;
        let lastTime = 0;
        let speed = 120; // milisegundos

        function createBoard() {
            board.innerHTML = '';
            board.appendChild(msg); // Mantener el mensaje de error

            // Dibujar serpiente
            snake.forEach(segment => {
                const el = document.createElement('div');
                el.style.gridColumnStart = segment.x;
                el.style.gridRowStart = segment.y;
                el.classList.add('snake');
                board.appendChild(el);
            });

            // Dibujar comida
            const foodEl = document.createElement('div');
            foodEl.style.gridColumnStart = food.x;
            foodEl.style.gridRowStart = food.y;
            foodEl.classList.add('food');
            board.appendChild(foodEl);
        }

        function setDir(x, y) {
            // Si el juego terminó, cualquier dirección lo reinicia
            if (msg.style.display === 'block') {
                msg.style.display = 'none';
                resetGame();
            }

            // Evitar que la serpiente se de la vuelta sobre sí misma
            if (x !== 0 && direction.x !== 0) return;
            if (y !== 0 && direction.y !== 0) return;
            
            // Si el juego estaba detenido al inicio, arrancar
            if (direction.x === 0 && direction.y === 0) {
                msg.style.display = 'none';
            }
            
            nextDirection = {x, y};
        }

        function update() {
            if (!gameRunning) return;

            direction = nextDirection;
            if (direction.x === 0 && direction.y === 0) return;

            const head = {x: snake[0].x + direction.x, y: snake[0].y + direction.y};
            
            // Colisiones con paredes
            if (head.x < 1 || head.x > gridSize || head.y < 1 || head.y > gridSize || 
                snake.some((s, index) => index !== 0 && s.x === head.x && s.y === head.y)) {
                
                msg.style.display = 'block';
                // Detenemos el movimiento hasta que el usuario reinicie
                direction = {x: 0, y: 0};
                nextDirection = {x: 0, y: 0};
                return;
            }

            snake.unshift(head);

            // ¿Comió?
            if (head.x === food.x && head.y === food.y) {
                score += 10;
                scoreElement.innerText = score;
                generateFood();
            } else {
                snake.pop();
            }
        }

        function generateFood() {
            let newFood;
            while (true) {
                newFood = {
                    x: Math.floor(Math.random() * gridSize) + 1,
                    y: Math.floor(Math.random() * gridSize) + 1
                };
                // Que no aparezca dentro de la serpiente
                if (!snake.some(s => s.x === newFood.x && s.y === newFood.y)) break;
            }
            food = newFood;
        }

        function resetGame() {
            snake = [{x: 10, y: 10}];
            nextDirection = {x: 0, y: 0};
            direction = {x: 0, y: 0};
            score = 0;
            scoreElement.innerText = score;
            generateFood();
        }

        window.addEventListener('keydown', e => {
            switch (e.key) {
                case 'ArrowUp': setDir(0, -1); break;
                case 'ArrowDown': setDir(0, 1); break;
                case 'ArrowLeft': setDir(-1, 0); break;
                case 'ArrowRight': setDir(1, 0); break;
            }
        });

        function main(currentTime) {
            window.requestAnimationFrame(main);
            const secondsSinceLastRender = (currentTime - lastTime);
            if (secondsSinceLastRender < speed) return;

            lastTime = currentTime;
            update();
            createBoard();
        }

        window.requestAnimationFrame(main);
    </script>
</body>
</html>